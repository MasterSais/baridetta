var n=this&&this.__assign||function(){return(n=Object.assign||function(n){for(var r,t=1,e=arguments.length;t<e;t++)for(var u in r=arguments[t])Object.prototype.hasOwnProperty.call(r,u)&&(n[u]=r[u]);return n}).apply(this,arguments)};!function(n){if("object"==typeof module&&"object"==typeof module.exports){var r=n(require,exports);void 0!==r&&(module.exports=r)}else"function"==typeof define&&define.amd&&define(["require","exports"],n)}((function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.V_INT="integer",t.V_EQ="equal",t.V_REG="regex",t.V_NEQ="notEqual",t.V_GTE="gte",t.V_LTE="lte",t.V_OOF="oneOf",t.V_LEN="len",t.V_MXLEN="maxLen",t.V_MNLEN="minLen",t.V_FIELDS="fields",t.V_NUM="number",t.V_STR="string",t.V_BLN="bool",t.V_ARR="array",t.V_OBJ="object",t.G_CONS="consecutive",t.G_PRLL="parallel",t.G_OR="or",t.G_TRM="transform",t.S_GDP="getDep",t.S_SDP="setDep",t.S_SVDP="setVDep",t.S_DFT="useDefault",t.C_ERR="withError",t.C_MET="withMeta",t.C_PRM="withPromise";var e=function(n){return Array.isArray(n)?n:[n]},u=function(r,t){return r&&n(n({},r),{path:r.path.concat(t?[t]:[])})},o=function(r,t,e){return void 0===e&&(e=[]),r&&n(n({},r),{params:e,validator:t})},i=function(n,r,t){return t?t._deps[r]=n:n},c=function(n,r){return r?r._deps[n]:null},f=function(n,r,t){return r&&r(n,t),null},l=function(n){throw n},a=function(n){return null==n||""===n},_=function(n,r){return typeof n==typeof r},s=function(n){return void 0!==n},p=function(n){return Number.isFinite(n)},v=function(n){return"string"==typeof n},V=function(n){return"boolean"==typeof n},h=function(n){return"function"==typeof n},d=function(n){return"object"==typeof n},g=function(n){return n&&"object"==typeof n&&n.constructor===Object},E=function(n){return Array.isArray(n)},m=function(n){return n.reduce((function(n,r){return n&&h(r)}),!0)};t.consecutive=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return m(n)?function(r,t,e){return n.reduce((function(n,r){return null!==n?r(n,t,e):null}),r)}:l(t.G_CONS)},t.or=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return m(n)?function(r,t,e){var u=null,o={value:!1};return n.find((function(n){return null!==(u=n(r,t?function(n,r){return t(n,r,o)}:null,e))})),null===u&&(o.value=!0),u}:l(t.G_OR)},t.parallel=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return m(n)?function(r,t,e){return n.reduce((function(n,u){return null!==n?u(r,t,e):(u(r,t,e),null)}),r)}:l(t.G_PRLL)},t.transform=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return m(n)?function(r){return n.reduce((function(n,r){return r(n)}),r)}:l(t.G_TRM)},t.getDep=function(n,r){return v(n)&&n.length>0?h(r)?function(u,o,i){var f=r(c(n,i));if(!f)return u;var a=e(f);return m(a)?a.reduce((function(n,r){return null!==n?r(n,o,i):null}),u):l(t.S_GDP)}:function(r,t,e){return c(n,e)}:l(t.S_GDP)},t.setDep=function(n,r){return v(n)&&n.length>0?function(t,e,u){return i(s(r)?h(r)?r(u):r:t,n,u)}:l(t.S_SDP)},t.setVDep=function(n){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return v(n)&&n.length>0&&m(r)&&r.length>0?function(t,e,u){return i(r,n,u),r.reduce((function(n,r){return null!==n?r(n,e,u):null}),t)}:l(t.S_SVDP)},t.useDefault=function(n){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return m(r)?function(t,e,u){return a(t)?h(n)?n(u):n:r.reduce((function(n,r){return null!==n?r(n,e,u):null}),t)}:l(t.S_DFT)},t.array=function(n,r){var i=e(n),c=m(i);if(!n||c){var a=c&&t.consecutive.apply(void 0,i);return function(n,e,i){return E(n)?a?n.map((function(n,r){return a(n,e,u(i,r))})):n:f(r,e,o(i,t.V_ARR,[n]))}}return l(t.V_ARR)};var O=[!1,!0,0,1,"0","1","false","true"];t.bool=function(n){return function(r,e,u){var i=O.indexOf(r);return i>=0?!!(i%2):f(n,e,o(u,t.V_BLN))}},t.equal=function(n,r){return function(e,u,i){return e===n?e:f(r,u,o(i,t.V_EQ,[n]))}};var y={op:function(n,r){return r.reduce((function(r,t){return r+Number(v(t)?!a(n[t]):y[t[0]](n,t.slice(1)))}),0)},"&":function(n,r){return y.op(n,r)===r.length},"|":function(n,r){return y.op(n,r)>0},"^":function(n,r){return 1===y.op(n,r)}},L=function(n){return["&","|","^"].indexOf(n)>=0},N=function(n){return v(n)&&n.length>0&&!L(n)||E(n)&&n.length>2&&L(n[0])&&n.reduce((function(n,r,t){return 0===t||n&&N(r)}),!0)};t.fields=function(n,r){return N(n)?function(e,u,i){return g(e)&&y.op(e,[n])>0?e:f(r,u,o(i,t.V_FIELDS,[n]))}:l(t.V_FIELDS)},t.gte=function(n,r){return p(n)||v(n)||V(n)?function(e,u,i){return _(e,n)&&e>=n?e:f(r,u,o(i,t.V_GTE,[n]))}:l(t.V_GTE)},t.integer=function(n){return function(r,e,u){return function(n){return"number"==typeof n}(r)&&r%1==0?r:f(n,e,o(u,t.V_INT))}},t.len=function(n,r){return p(n)&&n>=0?function(e,u,i){return null!==e&&(d(e)||v(e))&&p(e.length)&&e.length===n?e:f(r,u,o(i,t.V_LEN,[n]))}:l(t.V_LEN)},t.lte=function(n,r){return p(n)||v(n)||V(n)?function(e,u,i){return _(e,n)&&e<=n?e:f(r,u,o(i,t.V_LTE,[n]))}:l(t.V_LTE)},t.maxLen=function(n,r){return p(n)&&n>=0?function(e,u,i){return null!==e&&(d(e)||v(e))&&p(e.length)&&e.length<=n?e:f(r,u,o(i,t.V_MXLEN,[n]))}:l(t.V_MXLEN)},t.minLen=function(n,r){return p(n)&&n>=0?function(e,u,i){return null!==e&&(d(e)||v(e))&&p(e.length)&&e.length>=n?e:f(r,u,o(i,t.V_MNLEN,[n]))}:l(t.V_MNLEN)},t.notEqual=function(n,r){return function(e,u,i){return e!==n?e:f(r,u,o(i,t.V_NEQ,[n]))}},t.number=function(n){return function(r,e,u){return null!==r&&""!==r&&!E(r)&&function(n){return(global||window).isFinite(n)}(r)?Number(r):f(n,e,o(u,t.V_NUM))}},t.object=function(n,r){var i=[],c=g(n);if(c&&Object.keys(n).forEach((function(r){return i.push([r,e(n[r])])})),c||!n){var a=n&&i.map((function(n){var r=n[0],e=n[1];return[r,t.consecutive.apply(void 0,e)]}));return function(e,i,c){return null!==e&&g(e)?a?a.reduce((function(n,r){var t=r[0],o=r[1];return n[t]=o(e[t],i,u(c,t)),n}),{}):e:f(r,i,o(c,t.V_OBJ,[n]))}}return l(t.V_OBJ)};t.object2=function(n,r){var i,c=[],a=E(i=n)&&i.reduce((function(n,r){return n&&E(r)}),!0);if(a&&n.forEach((function(n){var r=n[0],t=n.slice(1);return c.push([r,e(t)])})),a&&c.reduce((function(n,r){var t=r[0];return n&&t.length>0}),!0)||!n){var _=n&&c.map((function(n){var r=n[0],e=n[1];return[r,t.consecutive.apply(void 0,e)]}));return function(e,i,c){return null!==e&&g(e)?_?_.reduce((function(n,r){var t=r[0],o=r[1];return n[t]=o(e[t],i,u(c,t)),n}),{}):e:f(r,i,o(c,t.V_OBJ,[n]))}}return l(t.V_OBJ)},t.oneOf=function(n,r){return E(n)?function(e,u,i){return null!==e&&n.indexOf(e)>=0?e:f(r,u,o(i,t.V_OOF,[n]))}:l(t.V_OOF)},t.regex=function(n,r){return n&&n.constructor===RegExp?function(e,u,i){return n.test(e)?e:f(r,u,o(i,t.V_REG,[n]))}:l(t.V_REG)},t.string=function(n){return function(r,e,u){return!s(r)||d(r)||h(r)?f(n,e,o(u,t.V_STR)):r+""}},t.clamp=function(n,r){return function(t){return t<n?n:t>r?r:t}},t.withErrors=function(n,r){return h(n)?function(t,e,u){var o=[],i=function(n,r){return o.push({error:n,relevance:r||{value:!0}})};return{result:n(t,(function(n,t,e){return n&&(h(n)?i(n(t),e):i(n,e))||r&&i(r(t),e)}),u),errors:o.length>0?o.filter((function(n){return n.relevance.value})).map((function(n){return n.error})):null}}:l(t.C_ERR)},t.withMeta=function(n){return h(n)?function(r,t){return n(r,t,{path:[],_deps:{},params:[]})}:l(t.C_MET)},t.withPromise=function(n){return h(n)?function(r,t,e){return new Promise((function(u,o){var i=n(r,t,e);i.errors?o(i.errors):u(i.result||i)}))}:l(t.C_PRM)}}));