export const V_INT="integer";export const V_EQ="equal";export const V_REG="regex";export const V_NEQ="notEqual";export const V_GTE="gte";export const V_LTE="lte";export const V_OOF="oneOf";export const V_LEN="len";export const V_MXLEN="maxLen";export const V_MNLEN="minLen";export const V_FIELDS="fields";export const V_NUM="number";export const V_STR="string";export const V_BLN="bool";export const V_ARR="array";export const V_OBJ="object";export const G_CONS="consecutive";const e=e=>Array.isArray(e)?e:[e],t=(e,t)=>e&&{...e,path:e.path.concat(t?[t]:[])},o=(e,t,o=[])=>e&&{...e,params:o,validator:t},n=(e,t,o)=>o?o._deps[t]=e:e,r=(e,t)=>t&&t._deps[e]||null,c=(e,t,o)=>(t&&t(e,o),null),s=e=>{throw e},l=e=>null==e||""===e,p=(e,t)=>typeof e==typeof t,u=e=>void 0!==e,x=e=>Number.isFinite(e),a=e=>"string"==typeof e,i=e=>"boolean"==typeof e,_=e=>"function"==typeof e,V=e=>"object"==typeof e,d=e=>e&&"object"==typeof e&&e.constructor===Object,f=e=>Array.isArray(e),g=e=>e.reduce((e,t)=>e&&_(t),!0);export const consecutive=(...e)=>g(e)?(t,o,n)=>e.reduce((e,t)=>null!==e?t(e,o,n):null,t):s(G_CONS);export const getDep=(t,o)=>(n,c,s)=>e(o(r(t,s))).reduce((e,t)=>null!==e?t(e,c,s):null,n);export const mergeDep=e=>(t,o,n)=>r(e,n);export const or=(...e)=>(t,o,n)=>{let r=null;const c={value:!1};return e.find(e=>(r=e(t,o?(e,t)=>o(e,t,c):null,n),null!==r)),null===r&&(c.value=!0),r};export const parallel=(...e)=>(t,o,n)=>e.reduce((e,r)=>null!==e?r(e,o,n):(r(t,o,n),null),t);export const setDep=(e,t)=>(o,r,c)=>n(u(t)?t:o,e,c);export const setVDep=(e,...t)=>(o,r,c)=>(n(t,e,c),t.reduce((e,t)=>null!==e?t(e,r,c):null,o));export const transform=(...e)=>(t,o,n)=>e.reduce((e,t)=>t(e,o,n),t);export const useDefault=(e,...t)=>(o,n,r)=>l(o)?_(e)?e(r):e:t.reduce((e,t)=>null!==e?t(e,n,r):null,o);export const array=(n,r)=>{const l=e(n),p=g(l);if(!n||p){const e=p&&consecutive(...l);return(n,s,l)=>f(n)?e?n.map((o,n)=>e(o,s,t(l,n))):n:c(r,s,o(l,V_ARR,[n]))}return s(V_ARR)};const h=[!1,!0,0,1,"0","1","false","true"];export const bool=e=>(t,n,r)=>{const s=h.indexOf(t);return s>=0?!!(s%2):c(e,n,o(r,V_BLN))};export const equal=(e,t)=>(n,r,s)=>n===e?n:c(t,r,o(s,V_EQ,[e]));const E={op:(e,t)=>t.reduce((t,o)=>t+Number(a(o)?!l(e[o]):E[o[0]](e,o.slice(1))),0),"&":(e,t)=>E.op(e,t)===t.length,"|":(e,t)=>E.op(e,t)>0,"^":(e,t)=>1===E.op(e,t)},N=e=>["&","|","^"].indexOf(e)>=0,m=e=>a(e)&&e.length>0&&!N(e)||f(e)&&e.length>2&&N(e[0])&&e.reduce((e,t,o)=>0===o||e&&m(t),!0);export const fields=(e,t)=>m(e)?(n,r,s)=>d(n)&&E.op(n,[e])>0?n:c(t,r,o(s,"fields",[e])):s("fields");export const gte=(e,t)=>x(e)||a(e)||i(e)?(n,r,s)=>p(n,e)&&n>=e?n:c(t,r,o(s,"gte",[e])):s("gte");export const integer=e=>(t,n,r)=>(e=>"number"==typeof e)(t)&&t%1==0?t:c(e,n,o(r,V_INT));export const len=(e,t)=>x(e)&&e>=0?(n,r,s)=>null!==n&&(V(n)||a(n))&&x(n.length)&&n.length===e?n:c(t,r,o(s,"len",[e])):s("len");export const lte=(e,t)=>x(e)||a(e)||i(e)?(n,r,s)=>p(n,e)&&n<=e?n:c(t,r,o(s,"lte",[e])):s("lte");export const maxLen=(e,t)=>x(e)&&e>=0?(n,r,s)=>null!==n&&(V(n)||a(n))&&x(n.length)&&n.length<=e?n:c(t,r,o(s,V_MXLEN,[e])):s(V_MXLEN);export const minLen=(e,t)=>x(e)&&e>=0?(n,r,s)=>null!==n&&(V(n)||a(n))&&x(n.length)&&n.length>=e?n:c(t,r,o(s,V_MNLEN,[e])):s(V_MNLEN);export const notEqual=(e,t)=>(n,r,s)=>n!==e?n:c(t,r,o(s,V_NEQ,[e]));export const number=e=>(t,n,r)=>null!==t&&""!==t&&!f(t)&&(e=>(global||window).isFinite(e))(t)?Number(t):c(e,n,o(r,V_NUM));export const object=(n,r)=>{const l=[],p=d(n);if(p&&Object.keys(n).forEach(t=>l.push([t,e(n[t])])),p&&l.reduce((e,[t,o])=>e&&g(o),!0)||!n){const e=n&&l.map(([e,t])=>[e,consecutive(...t)]);return(s,l,p)=>null!==s&&d(s)?e?e.reduce((e,[o,n])=>(e[o]=n(s[o],l,t(p,o)),e),{}):s:c(r,l,o(p,V_OBJ,[n]))}return s(V_OBJ)};export const object2=(n,r)=>{const l=[],p=f(u=n)&&u.reduce((e,t)=>e&&f(t),!0);var u;if(p&&n.forEach(([t,...o])=>l.push([t,e(o)])),p&&l.reduce((e,[t,o])=>e&&g(o)&&t.length>0,!0)||!n){const e=n&&l.map(([e,t])=>[e,consecutive(...t)]);return(s,l,p)=>null!==s&&d(s)?e?e.reduce((e,[o,n])=>(e[o]=n(s[o],l,t(p,o)),e),{}):s:c(r,l,o(p,V_OBJ,[n]))}return s(V_OBJ)};export const oneOf=(e,t)=>f(e)?(n,r,s)=>null!==n&&e.indexOf(n)>=0?n:c(t,r,o(s,V_OOF,[e])):s(V_OOF);export const regex=(e,t)=>e&&e.constructor===RegExp?(n,r,s)=>e.test(n)?n:c(t,r,o(s,V_REG,[e])):s(V_REG);export const string=e=>(t,n,r)=>!u(t)||V(t)||_(t)?c(e,n,o(r,V_STR)):t+"";export const clamp=(e,t)=>o=>o<e?e:o>t?t:o;export const withErrors=(e,t)=>(o,n,r)=>{const c=[],s=(e,t)=>c.push({error:e,relevance:t||{value:!0}});return{result:e(o,(e,o,n)=>e&&(_(e)?s(e(o),n):s(e,n))||t&&s(t(o),n),r),errors:c.length>0?c.filter(({relevance:e})=>e.value).map(({error:e})=>e):null}};export const withMeta=e=>(t,o)=>e(t,o,{path:[],_deps:{},params:[]});export const withPromise=e=>(t,o,n)=>new Promise((r,c)=>{const s=e(t,o,n);s.errors?c(s.errors):r(s.result||s)});